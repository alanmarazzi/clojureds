;; gorilla-repl.fileformat = 1

;; **
;;; # Chapter 2 - Inference
;; **

;; @@
(ns ws.ch2
  (:require [clj-time.format :as f]
            [clj-time.predicates :as p]
            [medley.core :refer [map-vals]]
            [clj-time.core :as t]
            [incanter.charts :as c]
            [incanter.core :as i]
            [incanter.io :as iio]
            [incanter.stats :as s]
            [incanter.svg :as svg]
            [clj-time.coerce :as tc]
            [clojure.java.io :as io]
            [clojure.repl :refer [doc]]
            [clojure.pprint :as pp]))

(use 'incanter-gorilla.render :reload)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## AcmeContent
;;; 
;;; Let's pretend we just got hired by **AcmeContent** to anlayze their website dwell time
;; **

;; @@
(defn load-data
  [file]
  (-> (io/resource file)
      (iio/read-dataset :header true :delim \tab)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/load-data</span>","value":"#'ws.ch2/load-data"}
;; <=

;; @@
(-> (load-data "dwell-times.tsv")
    (i/view))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>#object[javax.swing.JFrame 0x57cb755c &quot;javax.swing.JFrame[frame0,1280,0,400x600,invalid,layout=java.awt.BorderLayout,title=Incanter Dataset,resizable,normal,defaultCloseOperation=HIDE_ON_CLOSE,rootPane=javax.swing.JRootPane[,0,0,400x600,invalid,layout=javax.swing.JRootPane$RootLayout,alignmentX=0.0,alignmentY=0.0,border=,flags=16777673,maximumSize=,minimumSize=,preferredSize=],rootPaneCheckingEnabled=true]&quot;]</span>","value":"#object[javax.swing.JFrame 0x57cb755c \"javax.swing.JFrame[frame0,1280,0,400x600,invalid,layout=java.awt.BorderLayout,title=Incanter Dataset,resizable,normal,defaultCloseOperation=HIDE_ON_CLOSE,rootPane=javax.swing.JRootPane[,0,0,400x600,invalid,layout=javax.swing.JRootPane$RootLayout,alignmentX=0.0,alignmentY=0.0,border=,flags=16777673,maximumSize=,minimumSize=,preferredSize=],rootPaneCheckingEnabled=true]\"]"}
;; <=

;; @@
(-> (i/$ :dwell-time (load-data "dwell-times.tsv"))
    (c/histogram :nbins 50)
    (chart-view))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x47d0eb0b \"org.jfree.chart.JFreeChart@47d0eb0b\"], :opts nil}"}
;; <=

;; @@
(-> (i/$ :dwell-time (load-data "dwell-times.tsv"))
    (c/histogram :nbins 50)
    (c/set-axis :y (c/log-axis))
    (chart-view))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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mmuuKXbv3l0cP368+O233zb/vdtvFlsH+WojP/nWz3jPnj224QY5ttV/bduAnq133323uP/++4vLly+neuCBB9I8yteRI0eKc+fOpZsq/P3338WJEycS4KuD3Dpo1iSb5Cff+jpz5swWONiG291m29p25Q7oWxQbw5dffrk5HY/vu+8+a7WBAuxXX3119uC2Dpo1x0H5ybe+Dhw4UFy6dMk2PGKgN9125Q7oW3TttdcmAFVhFPNoeJ09e7Y4ePDglsEdhy8D8vv37y9eeukl66Bmc2ySn3zrb7/PPvtsq+sA0Ifrv7ZtQG+84VX3Lqmefvjhh2Lfvn3F2tpa13+/cOFCcfjw4eKFF16wDobQMPnJt57uvffevveRtg23B/Sm267cAd0n6xHpq6++Km699dbim2++6fu8P/74I53AYh0Mp7r5yTdfccj26NGjra8DQLeHDuhjULfvYGIe1dOnn35a3HLLLcX3339fuxlaB82APig/+eYrvn/97rvvbMNjAnrTbVfugL5F5VmScZmVsySH01tvvVXs3bu352HKY8eOFT///HN6/OuvvxaPPvrolu8orYP+apqffPP09ddf9zyhyjbcDtA75zfdduUO6FcoLk9xHWOzwdvvOt3Ye7/rrrvSvJtvvjl99xiXt1kH+Uc/muYn38EKGHzxxRcjWwc7tRcMAn3TbVfugE5ERGNW/PgUAToREREBOhEREQE6ERERoBMRERGgExEREaATERERoBMREQE6jV6nT59OP9YQv1xVqtsPOgxS3efXfe9Rvv8gv6b+417+Ua/r7V6fk5Kn7Zg69cgjj6SMYqzlzAd0ak3//vtvceONNxZXXXXV5s9S9hu4x48fL26//XZAr7mck9AI667rWQN62//P6vs13T5sx9PVL/qt+xhbMX3DDTekMTdoPqBTa/rwww/TRnbkyJGs5990003FiRMnNqd///334rnnnks/ZRnvE7D/5JNPAH2K1jWgA/qs7YlvJ9BDDz/8cJr3wQcfZM0HdGpFjz/+eNrAotkPGhBxB6mYd+7cuc15ceg25sXtTuPvpUuXiqeffrrRgHv//ffTLVTjJx73799fvPfee1c8P+bHdPWe6fFhI/ZAS8V91eM5t91225b3jxtoHDp0KN0iMe57fPfddxcff/xx40bY7zeoe03HTSDK/+sdd9xRnD17tjh58mT6f8S8e+65p/jxxx9rL3/TdX3+/Pl0k5HwiIrHMa9Tb775Znpt7PXv2bMn3WwkPuTVXZ/9lPv6fssy6PfBc/4fdZu67bj5dhw3sXnqqaeK3bt3p+fEunnyySf73l653/IPer9Yznj+mTNntrxnTMf8uM99zrr/6KOP0rwYcznzAZ1aUdyuNDaw9fX1gU3+1KlTV9w7OAZFPO/PP/+s9Ym4V2P5/PPP0/zDhw+nhhoVjzufH0cJYjru0haKhlg+JxpgtUk///zzm6+L+61H037wwQfTh4849PXMM8+k50XDHdehynI6mkssQ8Cyc17c5COmo9HVXf4m6zo+sFXXQdzms1wH1Q9zoVdffbX45Zdf0uM4MhPPieWpuz57qc7rBy1LP89Br60LdNtxO9vxgQMH0rzyw+Rff/2VoB83wRlm+Qe93zvvvJP+Pb7vrqr8/jv+PQfo8cEh5sWYy5kP6NSKSiDnDIj49Nr5yTL2JuJ55Z5G7JXERjtsw4jbGMb86qf5cg+l+vyySRw9ejRNv/baa5vPiceh+LeYrt79KgZuzCubd+iff/65Yg9oXI2whGt8SOqcF4qmF1V3+Zus627rIB7HvF63Bq2+V+z91F2fvdTk9Z3LUueoQOdr68p23M52XL6uegSjyQ7DoPcLwMc4iefE7VRD8Tem40hD7LjUWYZuN5LpNR/QaWxAj0/R3b77iU/TsbFXD2/FdIB9GMWGnrM80Thi2eN2h6GHHnooPb7++uvTnlAopuM53Y4odKtqw8k91JjbMHOelzMvd/mbrOt+z4sjNKWiGcd3ggG+zm2g7vrslWfu63OWpde6yXmt7Xh7tuNyj7qEYOzlx1GNjY2NRnvo/d4vTvyNf3/99dfTdPyN6Zhf90MFoNNEHnIPQMdAu3z58hXvEWdvvvHGG+n55R57/B1lI6weBvv2229Tg4ijB1HxOObFv0Wj7vb+1eaY0xAmpRHmLn+TdZ0L9LI59jvEOy6g5yzLoCbf77W24+3ZjuNo37Fjx9J38dXlrB6+rwP0nPeL7/ar88p72Mf8XJWH1vfu3Zs1H9CpFeWeKBXPK08I6TeIAvg5n0CbHnIPvf3222leefgujh6UJ53Ed3PxN55TVZyEE/PjpJ0mjbCtQ5V1G2Hu8jdZ1+U6qB6W7HbIvRP85WU5gw7fj+KQe86y9PLMee2oDrnbjvO34/ie/bPPPkuvi3VWdxly3y9UfoUY66K8eqeOnBRH26Jyg+13KVN8io7Dft1+ECFeFydKld+dlc0wBuwwDaN6MlGcjBUVHt2ef/HixS2H6eLDRJx8VD1sGs+pKvZ4Yi8zBuiFCxfSvHhN5BBNuGkjjGtMy7P9R9EIc5d/2HUdKk9sisO/5Ulx5Tqofo8bezAxL5pifP9Z7mn2Ojls0PrsptzX5yxLr3WT89q6sh23sx3HNhhnmMd6qe49V3cuuvn1Wv6c9wvFSZLlNePV8xlyVV6e1vnVY6/5gE6tKD6llhttrx8bKRt8XLbWqfi3uHQtgF+eSBSHtIb9jqs8vL9v3770qTkGfEz3en75Sbo6IA8ePNj3JLHY83zsscfSspaDNs7IrV4KM2wjjMO2cSlM7qHOuo0wd/mHXdfV9RqNNY60xHqIPfPOM9yjEcfh6gBPHM4v9zS7Xb6Vuz6H3R5ylqXXusn9f9SV7bj5dhyPn3jiibQs5SWFnf2l23v3Wv6c9wuVJ8KVH7LKE+RyFNtT+f8pPzj0mw/o1Kpefvnl1LirPwdaVZw0kvOduJ+EnP51TUTNFGMrxtgrr7ySNR/Qaay68847s34sZtbP3CQiIkAnIiICdCIiIgJ0IiIiAnQiIiICdCIiIkAnIiIiQCciIiJAJyIionr6H9CfT6UldToMAAAAAElFTkSuQmCC\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x22c51bc7 \"org.jfree.chart.JFreeChart@22c51bc7\"], :opts nil}"}
;; <=

;; **
;;; ## Exponential distribution
;; **

;; @@
(let [dwell-times (->> (load-data "dwell-times.tsv")
                       (i/$ :dwell-time))]
  (println "Mean:   " (s/mean dwell-times))
  (println "Median: " (s/median dwell-times))
  (println "SD:     " (s/sd dwell-times)))
;; @@
;; ->
;;; Mean:    93.2014074074074
;;; Median:  64.0
;;; SD:      93.96972402519813
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(defn with-parsed-date
  [data]
  (i/transform-col data :date (comp tc/to-local-date f/parse)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/with-parsed-date</span>","value":"#'ws.ch2/with-parsed-date"}
;; <=

;; @@
(defn filter-weekdays
  [data]
  (i/$where {:date {:$fn p/weekday?}} data))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/filter-weekdays</span>","value":"#'ws.ch2/filter-weekdays"}
;; <=

;; @@
(defn mean-dwell-times-by-date
  [data]
  (i/$rollup :mean :dwell-time :date data))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/mean-dwell-times-by-date</span>","value":"#'ws.ch2/mean-dwell-times-by-date"}
;; <=

;; @@
(defn daily-mean-dwell-times
  [data]
  (->> (with-parsed-date data)
       (filter-weekdays)
       (mean-dwell-times-by-date)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/daily-mean-dwell-times</span>","value":"#'ws.ch2/daily-mean-dwell-times"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))]
  (println "Mean:   " (s/mean means))
  (println "Median: " (s/median means))
  (println "SD:     " (s/sd means)))
;; @@
;; ->
;;; Mean:    90.210428650562
;;; Median:  90.13661202185791
;;; SD:      3.722342905320035
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))]
  (-> (c/histogram means :nbins 20)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x58606b98 \"org.jfree.chart.JFreeChart@58606b98\"], :opts nil}"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))
      mean (s/mean means)
      sd (s/sd means)
      pdf (fn [x]
            (s/pdf-normal x :mean mean :sd sd))]
  (-> (c/histogram means :nbins 20 :density true)
      (c/add-function pdf 80 100)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x7d4954ab \"org.jfree.chart.JFreeChart@7d4954ab\"], :opts nil}"}
;; <=

;; **
;;; ## Standard Error
;;; 
;;; We have just calculated the **standard error** (the difference between the sample's mean and the grand mean) empirically, but we can do it by a single sample doing:
;;; 
;;; $$SE=\frac{\sigma_x}{\sqrt{n}}$$
;;; 
;;; Where @@\sigma_x@@ is the **standard deviation** and @@n@@ is the sample size.
;; **

;; @@
(defn standard-deviation
  [xs]
  (Math/sqrt (s/variance xs)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/standard-deviation</span>","value":"#'ws.ch2/standard-deviation"}
;; <=

;; @@
(defn standard-error
  [xs]
  (/ (standard-deviation xs)
     (Math/sqrt (count xs))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/standard-error</span>","value":"#'ws.ch2/standard-error"}
;; <=

;; @@
(defn filtered-times
  [filter data]
  (->> (i/$where filter data)
       (i/$ :dwell-time)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/filtered-times</span>","value":"#'ws.ch2/filtered-times"}
;; <=

;; @@
(let [may-1 (f/parse-local-date "2015-05-01")]
  (->> (load-data "dwell-times.tsv")
       (with-parsed-date)
       (filtered-times {:date {:$eq may-1}})
       (standard-error)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>3.6300706763962207</span>","value":"3.6300706763962207"}
;; <=

;; **
;;; ## Confidence Intervals
;; **

;; @@
(defn confidence-interval
  [p xs]
  (let [x-bar (s/mean xs)
        se (standard-error xs)
        z-crit (s/quantile-normal 
                 (- 1 (/ (- 1 p) 2)))]
    [(- x-bar (* se z-crit))
     (+ x-bar (* se z-crit))]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/confidence-interval</span>","value":"#'ws.ch2/confidence-interval"}
;; <=

;; @@
(let [may-1 (f/parse-local-date "2015-05-01")]
  (->> (load-data "dwell-times.tsv")
       (with-parsed-date)
       (filtered-times {:date {:$eq may-1}})
       (confidence-interval 0.95)))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>83.52880123548485</span>","value":"83.52880123548485"},{"type":"html","content":"<span class='clj-double'>97.75841680962793</span>","value":"97.75841680962793"}],"value":"[83.52880123548485 97.75841680962793]"}
;; <=

;; **
;;; ## Sample comparisons
;; **

;; @@
(let [times (->> (load-data "campaign-sample.tsv")
                 (i/$ :dwell-time))]
  (println "n:      " (count times))
  (println "Mean:   " (s/mean times))
  (println "Median: " (s/median times))
  (println "SD:     " (s/sd times))
  (println "SE:     " (standard-error times)))
;; @@
;; ->
;;; n:       300
;;; Mean:    130.22
;;; Median:  84.0
;;; SD:      136.13370714388046
;;; SE:      7.859683246530105
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(->> (load-data "campaign-sample.tsv")
     (i/$ :dwell-time)
     (confidence-interval 0.95))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>114.81530390690814</span>","value":"114.81530390690814"},{"type":"html","content":"<span class='clj-double'>145.62469609309184</span>","value":"145.62469609309184"}],"value":"[114.81530390690814 145.62469609309184]"}
;; <=

;; **
;;; ### Biased sample
;;; 
;;; If we inspect the sample given to us (**campaign-sample**), we will find that the data comes from a weekend, likely to be biased.
;; **

;; @@
(p/weekend? (t/date-time 2015 6 6))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>true</span>","value":"true"}
;; <=

;; **
;;; ### Visualizing different populations
;;; 
;;; Since we always filtered out weekends, let's check whether we have a difference between them and weekdays
;; **

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (with-parsed-date)
                 (mean-dwell-times-by-date)
                 (i/$ :dwell-time))]
  (-> (c/histogram means :nbins 20)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x1fb293b3 \"org.jfree.chart.JFreeChart@1fb293b3\"], :opts nil}"}
;; <=

;; **
;;; As we can easily see in the chart, the distribution isn't normal anymore, it is **bimodal**. The second peak is due to weekends
;; **

;; @@
(defn print-stats
  [data]
  (println "n:      " (count data))
  (println "Mean:   " (s/mean data))
  (println "Median: " (s/median data))
  (println "SD:     " (s/sd data))
  (println "SE:     " (standard-error data)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/print-stats</span>","value":"#'ws.ch2/print-stats"}
;; <=

;; @@
(let [wknd-times (->> (load-data "dwell-times.tsv")
                      (with-parsed-date)
                      (i/$where 
                        {:date {:$fn p/weekend?}})
                      (i/$ :dwell-time))]
  (print-stats wknd-times))
;; @@
;; ->
;;; n:       5860
;;; Mean:    117.78686006825939
;;; Median:  81.0
;;; SD:      120.65234077179389
;;; SE:      1.5761115224978066
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## Hypothesis testing
;;; 
;;; ### z-test
;;; 
;;; With **z-testing** we can compare 2 samples, since we have 2 samples we also have 2 standard errors. The **z-test** is performed against the pooled standard error, wich is:
;;; 
;;; $$\sigma\_{ab} = \sqrt{
;;; \frac{\sigma\_{a}^{2}}{n\_{a}} +
;;; \frac{\sigma\_{b}^{2}}{n\_{b}}
;;; }$$
;;; 
;;; Where @@\sigma\_{a}^{2}@@ is the variance of the sample @@a@@, and @@\sigma\_{b}^{2}@@ is the variance of the sample @@b@@.
;; **

;; @@
(defn pooled-standard-error
  [a b]
  (i/sqrt (+ (/ (i/sq (standard-deviation a)) 
                (count a))
             (/ (i/sq (standard-deviation b))
                (count b)))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/pooled-standard-error</span>","value":"#'ws.ch2/pooled-standard-error"}
;; <=

;; **
;;; To determine if the difference we see is unexpectedly large, we take the ratio of the observed difference between the means over the pooled standard error:
;;; 
;;; $$z=\frac{\bar{a}-\bar{b}}{\sigma_{ab}}$$
;; **

;; @@
(defn z-stat
  [a b]
  (-> (- (s/mean a)
         (s/mean b))
      (/ (pooled-standard-error a b))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/z-stat</span>","value":"#'ws.ch2/z-stat"}
;; <=

;; **
;;; This **z** ratio tells us how many standard errors apart the means are. Since the standard error has a normal distribution, we can associate this difference with a probability
;; **

;; @@
(defn z-test
  [a b]
  (s/cdf-normal (z-stat a b)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/z-test</span>","value":"#'ws.ch2/z-test"}
;; <=

;; @@
(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      a (get data 0)
      b (get data 1)]
  (println "a n: " (count a))
  (println "b n: " (count b))
  (println "z-stat: " (z-stat a b))
  (println "p-value: " (z-test a b)))
;; @@
;; ->
;;; a n:  284
;;; b n:  16
;;; z-stat:  -1.5985205593851322
;;; p-value:  0.05496358680268404
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(doc map-vals)
;; @@
;; ->
;;; -------------------------
;;; medley.core/map-vals
;;; ([f coll])
;;;   Maps a function over the values of an associative collection.
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(map-vals (fn [x] (* x 2)) {:a 1 :b 2 :c 3})
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:a</span>","value":":a"},{"type":"html","content":"<span class='clj-long'>2</span>","value":"2"}],"value":"[:a 2]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:b</span>","value":":b"},{"type":"html","content":"<span class='clj-long'>4</span>","value":"4"}],"value":"[:b 4]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:c</span>","value":":c"},{"type":"html","content":"<span class='clj-long'>6</span>","value":"6"}],"value":"[:c 6]"}],"value":"{:a 2, :b 4, :c 6}"}
;; <=

;; **
;;; ## t-distribution
;;; 
;;; The **degrees of freedom** is 2 less than the sum of the sample sizes:
;;; 
;;; $$t=\frac{\bar{a}-\bar{b}}{S_{ab}}$$
;;; 
;;; Where @@S\_{ab}@@ is the pooled standard error, but since the **t-test** is designed for small samples we can take the pooled standard error as @@S\_{ab}=\sqrt{S\_{a}^{2}+S\_{b}^{2}}@@
;; **

;; @@
(defn pooled-standard-error
  [a b]
  (i/sqrt (+ (i/sq (standard-error a))
             (i/sq (standard-error b)))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/pooled-standard-error</span>","value":"#'ws.ch2/pooled-standard-error"}
;; <=

;; @@
(def t-stat z-stat)

(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      a (get data 0)
      b (get data 1)]
  (t-stat a b))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>-1.5985205593851322</span>","value":"-1.5985205593851322"}
;; <=

;; @@
(defn t-test
  [a b]
  (let [df (+ (count a) (count b) -2)]
    (- 1 (s/cdf-t (i/abs (t-stat a b)) :df df))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/t-test</span>","value":"#'ws.ch2/t-test"}
;; <=

;; @@
(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      a (get data 0)
      b (get data 1)]
  (t-test a b))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>0.055493443183774915</span>","value":"0.055493443183774915"}
;; <=

;; **
;;; ## Two tail test
;; **

;; @@
(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      a (get data 0)
      b (get data 1)]
  (pp/pprint (s/t-test a :y b)))
;; @@
;; ->
;;; {:p-value 0.12756432502462456,
;;;  :df 17.7613823496861,
;;;  :n2 16,
;;;  :x-mean 87.95070422535211,
;;;  :y-mean 122.0,
;;;  :x-var 10463.941024237305,
;;;  :conf-int [-78.9894629402365 10.890871390940724],
;;;  :y-var 6669.866666666667,
;;;  :t-stat -1.5985205593851322,
;;;  :n1 284}
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## One-sample t-test
;;; 
;;; If we already know the population mean we can run a **one-sample t-test**
;; **

;; @@
(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      b (get data 1)]
  (pp/pprint (s/t-test b :mu 90)))
;; @@
;; ->
;;; {:p-value 0.13789520958229406,
;;;  :df 15,
;;;  :n2 nil,
;;;  :x-mean 122.0,
;;;  :y-mean nil,
;;;  :x-var 6669.866666666667,
;;;  :conf-int [78.48152745280898 165.51847254719104],
;;;  :y-var nil,
;;;  :t-stat 1.5672973291495713,
;;;  :n1 16}
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## Resampling
;; **

;; @@
(let [data (->> (load-data "new-site.tsv")
                (i/$where {:site {:$eq 1}})
                (i/$ :dwell-time))]
  (-> (s/bootstrap data s/mean :size 10000)
      (c/histogram :nbins 20)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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QD+NEFb4Oib++GuX//w4LgwAvY0UgbBXZ86cqblvvhR16dKl9P3vf//IS7OBbrFYLJbWLs1gQyyAfkI1dCIiotMkz9D//ww91hEREQF6Gylv5b6xsXHoVu5ERESAfgoUfc+P0g+9G1XW9oB33nnnnXdAJ0HOO++88847oJMg55133nnnHdCJiIg6SIBOREQE6ERERAToREREBOjUfJWNlzwwMFB3eyd4raVG0+wedRre0+p9eXk5Xb16NfX09KT+/v50/fr1bNyGToiDRsdcxVu7nvfD+u+UMqBRXLd7zgM61dX9+/d3BW0ntnyt5anRNLvNmIb3tHq/du1aevToUTYs8vb2drpx40ZWEHZSHNQDWj11wnk/yDnspDKgUVy3e84DOtVVTELz6tWrrgR6o2l2mzENb7sU6lEAFicw6magd8J5P8g57OQyYG9ct3vOAzrV1IMHD9LMzMy+QiBuv0USjIyMpIWFhY4t2BtN4tMJk/xULZwjFq5cudJRcVAP6PW8dcrkTlXOfaeXAXvjut1zHtCppi5fvlx3Tt7V1dU0OTmZZmdnu6am1qiWWmsa3nYu1F+8eJEuXLiQnj9/3lFxUMV7mbdOOO9V/XdyGVAW1+2e84BOpYpbSR999FHD/ba2trLGIWronVlDf/z4cTp//nx68uRJx8VB1bsTe711Sw29k8uAWnGthk4dqXgu9PTp064GeqNpdjthGt56hfrS0lIaHh5Oz54968g4OCzQO2X65Ub+O7UMqBfX7Z7zgE779PXXX9ds6DE9PZ3W1tay1+vr62lqamrfM7ZOKdgaTbPbCdPw1vJ+69atNDQ0VPN2ayfEQS3vjbx1yvTL9YDeqWVAo7hu95wHdNqnCNKHDx/WvLodHR3NCoPBwcHs2Vl0/2hXkDfqT9tomt12nYa3kfey7cV92jkOGnmv4q2dp1+uEvedWgY0iut2z3lAJyIi6gABOhEREaATERERoBMRERGgExEREaATEREBOhEREQE6ERERATodt377299mAy7EKFBHVa3BK6g58v86b92kn/3sZ9n/FmUUATo10Nu3b9O7776b3nnnnZ0hHg+q69evpw8++KClBddRfredCtvDHGsr/RVjA9BP9hzEZCQxClyj346ZyH7yk59kE4/E8uMf/zhbdxr2izIpjv3cuXNZWUWATnX017/+NUuYa9euHfo73nvvvXTjxg1AB/S6sUEnq6tXr2ZQr3f+v/nmm3T27NkMrDHxSiwB1lgX21q9X+inP/1pdvx37txxUgGd6ukXv/hFliwB9qJiIoZPP/009ff3Z3MADwwMpE8++WTfFIQxQ1N8/tGjR7vg8fnnn6eRkZHU09OTTV34xRdf7Pvt5eXlbFKI/Ao9Xse6g+5Xb7zmRj7qfTZ//+WXX6YrV65kv13c/qc//Sl7H3c34ntj0orvvvtu3+er/Bdliv1i//hcfP4vf/lLaeFc7zgajWXdyEOZjhobMcFF7uvixYvpwYMHaX5+PrtTFOt+9KMfpX/84x+7vismEAlAxTmI3/zwww/TvXv39h1b1XMSY5THOY3fy2uHe0FS9cKoyv9RK7YanZ+qvg97QffrX/862xZTjBZ/M9bFtlbvF7p79262PsoqAnSqo5haMJLl22+/3bX+0qVL2focnK9fv84KkriFV9Rnn322a97gvPCYnJzMCtK48o7af6z729/+tvO5KOT37heviwA4yH61Cq0qPmp9Nl8f++79f0J/+MMfdiAQ0I99f/WrX+37fKP/okxfffXVrs/Gkvvee6xVj6NMjT5bpqPGRsAvbp/G5/eui0lC4n2AK1cU+gHogO6rV6+y/eIYY7+4yDnMfxEwj3Max5ZfBISvw4DxKDGWK+IhgB0XGIfxfVigx4VVbHvz5s3Oungd66JsaPV++QVT2XpAJ9qjKETKkj0KklieP39e9/NRmypeOeeFR7GGFa9jXXGKxpiWsJn71Sq0qvhoBPSqbQti36ilHfS/KFOZ73i+WOX2ea3jOIyHMh01NvKLo4Dp3nXF78+VPwcu1qDzwv/9998/8jnJj6P4mweJk6PEWH7xFnkYFz9xt6IZvqv+dhx3rdgvXly0ar9G6wGdqALQ81pHnkhRY4pnoS9fvtzZJ2oNe59t1YNjFFiNfvew+zWqPdXz0QjoZYpCNp7tBSzywqnWbdVGx16mONYqx3SU46jy2Xo19GbERpV1eQyULUUIH/WcHLadwVFirAjzvVOYVvUN6IBOlKnWLfe4zTU9PZ091ywWJMVbofGMNxJzc3Pz1AK9io/DFPJ5IV689dkKoB/lOKp8tkzNjI0q6/L/Ir913wishz0nhwX6YWMsauM5zIuPjw7q+yhAb6db7kNDQwpsQKd6qtUorqh4dhfP+GK/KICKn718+XJp4VG8/VjvVnqz9qtSINfycZhCfu+FRt69pgwejY69TFVvuR/kOA7joZEOExsHXReNwuJ98Xb0Uc/JYYDezBgrwrysIehBfB8F6HnjtOIxrKys1GzEdtL7hTSKA3SqqLglWtZtLbqT3L9/f+cKOm+BmhfSUWvo6+vbN+BDXnjE5+s1BMsbRJXtV7z1WHW/6Kca6+JW70F81PtsvYIwal+5p/jufACMMng0+i/KVGwUl3fryT9b/I0qx1HLX5XPlumosXHQdX//+98z8EV/9tXV1Wxd/J8Ru3Hhc5hz0kygV4mxsrsO8R/VgvlBfB8F6P/617+yrmJx8ZDHWbyOdbGt1fuF8m5rVXuHADp1raJGkRf4xcZf0eXm448/zrrg5F2A4rZi/lwwB210TSorPKKrVhREUQu5cOFCzW5rUTBF4Rb7Ra217NZjlf3iNmsc497Cq5GPep+tVxBGARu3eOM74xbh7du3a36+yn9Rptgv9o/Pxefj/d7fqHIctfxV+WyZjhobh1kXdzl+/vOfZ8/H84FGomV8sWvYQc5JM4FeJcYO222tiu9Gx1vv+/O7RnFREvkVS7Sq39ttsFX7xTnNfRdvzxOgUw397ne/yxLqIEO/RqOfGDSEjnaLthMlNqhZijIpyqbf//73/gxAp+PSD3/4w/TLX/7SHwHoYoMI0Ik6W/mtRCIiQCciIiJAJyIiAnQiIiICdCIiIgJ0IiIiAnQiIiJAJyIiolOs/wJnYa90GqeKYQAAAABJRU5ErkJggg==\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x7bee113c \"org.jfree.chart.JFreeChart@7bee113c\"], :opts nil}"}
;; <=

;; **
;;; ## Multiple comparisons
;;; 
;;; Let's say the web team deploys 19 new site designs, each receives 5% of the visitors
;; **

;; @@
(->> (i/transform-col (load-data 
                        "multiple-sites.tsv")
                      :dwell-time float)
     (i/$rollup :mean :dwell-time :site)
     (i/$order :dwell-time :desc)
     (pp/pprint))
;; @@
;; ->
;;; {:column-names [:site :dwell-time],
;;;  :rows
;;;  ({:site 6, :dwell-time 144.19298245614036}
;;;   {:site 10, :dwell-time 129.95238095238096}
;;;   {:site 7, :dwell-time 123.36734693877551}
;;;   {:site 15, :dwell-time 119.34782608695652}
;;;   {:site 1, :dwell-time 106.0}
;;;   {:site 5, :dwell-time 102.33333333333333}
;;;   {:site 3, :dwell-time 97.47916666666667}
;;;   {:site 11, :dwell-time 96.98214285714286}
;;;   {:site 18, :dwell-time 94.81481481481481}
;;;   {:site 8, :dwell-time 94.34693877551021}
;;;   {:site 4, :dwell-time 94.33333333333333}
;;;   {:site 13, :dwell-time 90.73770491803279}
;;;   {:site 9, :dwell-time 89.82}
;;;   {:site 19, :dwell-time 89.28070175438596}
;;;   {:site 2, :dwell-time 88.22916666666667}
;;;   {:site 16, :dwell-time 86.74418604651163}
;;;   {:site 12, :dwell-time 80.95081967213115}
;;;   {:site 0, :dwell-time 79.85106382978724}
;;;   {:site 17, :dwell-time 77.8913043478261}
;;;   {:site 14, :dwell-time 74.76470588235294})}
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; To test wether any of the differences is statistically significant, we could compare the sites with each other as:
;; **

;; @@
(let [data (->> (load-data 
                  "multiple-sites.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      alpha 0.05]
  (doseq [[site-a times-a] data
          [site-b times-b] data
          :when (> site-a site-b)
          :let [p-val (-> (s/t-test
                            times-a
                            :y times-b)
                          (:p-value))]]
    (when (< p-val alpha)
      (println site-b "and" site-a
               "are significantly different:"
               (format "%.3f" p-val)))))
;; @@
;; ->
;;; 0 and 7 are significantly different: 0.035
;;; 0 and 15 are significantly different: 0.047
;;; 12 and 15 are significantly different: 0.037
;;; 14 and 15 are significantly different: 0.023
;;; 6 and 13 are significantly different: 0.025
;;; 10 and 13 are significantly different: 0.043
;;; 0 and 6 are significantly different: 0.006
;;; 4 and 6 are significantly different: 0.028
;;; 3 and 6 are significantly different: 0.039
;;; 2 and 6 are significantly different: 0.018
;;; 7 and 17 are significantly different: 0.031
;;; 15 and 17 are significantly different: 0.041
;;; 6 and 17 are significantly different: 0.005
;;; 10 and 17 are significantly different: 0.006
;;; 7 and 12 are significantly different: 0.028
;;; 6 and 12 are significantly different: 0.004
;;; 10 and 12 are significantly different: 0.004
;;; 6 and 19 are significantly different: 0.019
;;; 10 and 19 are significantly different: 0.032
;;; 6 and 11 are significantly different: 0.036
;;; 6 and 9 are significantly different: 0.026
;;; 7 and 14 are significantly different: 0.017
;;; 6 and 14 are significantly different: 0.003
;;; 10 and 14 are significantly different: 0.003
;;; 6 and 16 are significantly different: 0.033
;;; 0 and 10 are significantly different: 0.007
;;; 4 and 10 are significantly different: 0.047
;;; 2 and 10 are significantly different: 0.030
;;; 9 and 10 are significantly different: 0.047
;;; 6 and 18 are significantly different: 0.030
;;; 6 and 8 are significantly different: 0.040
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(doc doseq)
;; @@
;; ->
;;; -------------------------
;;; clojure.core/doseq
;;; ([seq-exprs &amp; body])
;;; Macro
;;;   Repeatedly executes body (presumably for side-effects) with
;;;   bindings and filtering as provided by &quot;for&quot;.  Does not retain
;;;   the head of the sequence. Returns nil.
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; It looks like many pages are actually better than others, but this is completely wrong. We are very likely to find such result for so many tests, a better test would be to compare the times against the baseline 0
;; **

;; @@
(let [data (->> (load-data 
                  "multiple-sites.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      alpha 0.05
      baseline (get data 0)]
  (doseq [[site-a times-a] data
          :let [p-val (-> (s/t-test 
                            times-a
                            :y baseline)
                          (:p-value))]]
    (when (< p-val alpha)
      (println site-a
               "is significantly different from 0:"
               (format "%.3f" p-val)))))
;; @@
;; ->
;;; 7 is significantly different from 0: 0.035
;;; 15 is significantly different from 0: 0.047
;;; 6 is significantly different from 0: 0.006
;;; 10 is significantly different from 0: 0.007
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## Bonferroni correction
;;; 
;;; With **Bonferroni correction** we reduce the probability of Type I errors when performing multiple tests.
;;; 
;;; The correction is easy, we just divide @@\alpha@@ by the number of tests @@k@@ we are performing:
;;; 
;;; $$\alpha=\frac{0.05}{k}$$
;; **

;; @@
(let [data (->> (load-data "multiple-sites.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial
                            map :dwell-time)))
      alpha (/ 0.05 (count data))]
  (doseq [[site-a times-a] data
          [site-b times-b] data
          :when (> site-a site-b)
          :let [p-val (-> (s/t-test times-a
                                    :y times-b)
                          (:p-value))]]
    (when (< p-val alpha)
      (println site-b "and" site-a
               "are significantly different:"
               (format "%.3f" p-val)))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## ANOVA
;;; 
;;; **ANOVA** compares variances instead of means, and does this by considering the ratio of the variance *between* the groups and the variance *within* the groups.
;;; 
;;; ## F-distribution
;;; 
;;; The **F-distribution** is characterized by 2 degrees of freedom: the sample size and the number of groups. The test representing the ratio of the variance within and between the groups is called **F-statistic**.
;;; 
;;; $$F=\frac{S\_{b}^{2}}{S\_{w}^{2}}$$
;;; 
;;; Here @@S\_{b}^{2}@@ is the variance *between*, and @@S\_{w}^{2}@@ is the variance within.
;;; 
;;; @@S\_{w}^{2}@@ is calculated as:
;;; 
;;; $$S\_{w}^{2}=\frac{SSW}{df1}=\frac{
;;; \sum\_{jk}(x\_{jk}-\bar{x}\_{k})^2
;;; }{(k-1)}$$
;; **

;; @@
(defn ssw
  [groups]
  (->> (map s/sum-of-square-devs-from-mean groups)
       (reduce +)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/ssw</span>","value":"#'ws.ch2/ssw"}
;; <=

;; **
;;; @@S\_{b}^{2}@@ has a similar formula:
;;; 
;;; $$S\_{b}^{2}=\frac{SST-SSW}{df1}$$
;; **

;; @@
(defn sst
  [groups]
  (->> (apply concat groups)
       (s/sum-of-square-devs-from-mean)))

(defn ssb
  [groups]
  (- (sst groups)
     (ssw groups)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/ssb</span>","value":"#'ws.ch2/ssb"}
;; <=

;; **
;;; **F-statistic** is defined as the ratio of the variance *between* and the variance *within*, so by combining our previous functions we can calculate it as follows
;; **

;; @@
(defn f-stat
  [groups df1 df2]
  (let [msb (/ (ssb groups) df1)
        msw (/ (ssw groups) df2)]
    (/ msb msw)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/f-stat</span>","value":"#'ws.ch2/f-stat"}
;; <=

;; **
;;; ## F-test
;;; 
;;; Once we have a statistic and a distribution, we just have to pick our @@\alpha@@ and compare the result on our data.
;;; 
;;; To perform multiple testing we will look up the **F-statistic** in properly parameterized **F-distribution**
;; **

;; @@
(defn f-test
  [groups]
  (let [n (count (apply concat groups))
        m (count groups)
        df1 (- m 1)
        df2 (- n m)
        f-stat (f-stat groups df1 df2)]
    (s/cdf-f f-stat
             :df1 df1
             :df2 df2
             :lower-tail? false)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/f-test</span>","value":"#'ws.ch2/f-test"}
;; <=

;; @@
(def multi-data (load-data "multiple-sites.tsv"))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/multi-data</span>","value":"#'ws.ch2/multi-data"}
;; <=

;; @@
(let [grouped (->> multi-data
                   (:rows)
                   (group-by :site)
                   (vals)
                   (map (partial 
                          map :dwell-time)))]
  (f-test grouped))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>0.014031745203649137</span>","value":"0.014031745203649137"}
;; <=

;; @@
(let [grouped (->> multi-data
                   (:rows)
                   (group-by :site)
                   (sort-by first)
                   (map second)
                   (map (partial 
                          map :dwell-time)))
      box-plot (c/box-plot (first grouped)
                           :x-label "Site"
                           :y-label "Time")
      add-box (fn [chart dwell-times]
                (c/add-box-plot chart dwell-times))]
  (-> (reduce add-box box-plot (rest grouped))
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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oi5NdIrdl3FMOc08Wmt5WC6tRu+prjWtRu/lrrc8pNn6rufYlisPtRxXreWhlrRqLQ/LpVVveVguvWbKA6ATERERoBMREQE6ERERAToREREBOhEREQE6ERERoBMRERGgExEREaATERERoBMREQE6ERERAToREREBOhF1mNJ8nC0RAToRpax79+6FkZGR5DGi8fnR8elSvb29Dzz6czHQAZ4I0IkoQzp69GgC5vfffz959vOnn34afvWrX4W9e/dqsRMBOhF1iuLzySOYl3tefDnAl3uW9NWrV5PnUXd3dyet/pdffjn84he/EGwiQCeiVmnTpk0JkPv7+8OxY8fC+fPnk2745Vrk1VroV65cCRs2bAivvfZauH37dpLWW2+9lXz23LlzAk4E6ETUCsWWc19f34LWdgTyG2+8kQC5XqAPDQ0l26empua3xW78uG3Hjh0CTgToRNQqxbHzS5cuhTfffHO+Cz66fBy9VqDHLvZKXfKlCwUiAnQiapPirPcI4DjjvV6gx+/E7fEigYgAnYhWUKUu8nj7Wr1Aj5Ph4vYLFy4IJBGgE1G7NDAwEM6ePRsmJyeT97FlHW9hi1COk+SqAfyFF15I3pePs0d9+OGHyez273//+2FiYiLZ9sknnyRpLr63nYgAnYhS0uuvvx5++MMfJmPncYw7joH/4Ac/CO+8886CbvPFQI8z1mMLvlJL/fr168mkutIM+gj/gwcPhmvXrgk4EaATERERoBMREQE6ERERAToREREBOhEREQE6ERERoBMRERGgExERUYr6/5GLuyV99UemAAAAAElFTkSuQmCC\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x614af41 \"org.jfree.chart.JFreeChart@614af41\"], :opts nil}"}
;; <=

;; **
;;; The **F-test** gave us a significant result of about *.14*, this means that we are seeing a genuine statistical  difference in variance.
;;; 
;;; In the above **box-plot** we see all the different sites, and while it might seem that the number *10* is the one with the highest variance, actually the number *6* has a higher mean.
;; **

;; @@
(let [site-0 (->> (i/$where {:site {:$eq 0}} multi-data)
                  (i/$ :dwell-time))
      site-10 (->> (i/$where {:site {:$eq 10}} multi-data)
                   (i/$ :dwell-time))]
  (pp/pprint (s/t-test site-10 :y site-0)))
;; @@
;; ->
;;; {:p-value 0.006881194013890424,
;;;  :df 82.19219492094416,
;;;  :n2 47,
;;;  :x-mean 129.95238095238096,
;;;  :y-mean 79.85106382978724,
;;;  :x-var 8119.704994192797,
;;;  :conf-int [14.151919298502698 86.05071494668476],
;;;  :y-var 6262.390379278448,
;;;  :t-stat 2.772438317643114,
;;;  :n1 42}
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(let [site-0 (->> (i/$where {:site {:$eq 0}} multi-data)
                  (i/$ :dwell-time))
      site-6 (->> (i/$where {:site {:$eq 6}} multi-data)
                   (i/$ :dwell-time))]
  (pp/pprint (s/t-test site-6 :y site-0)))
;; @@
;; ->
;;; {:p-value 0.005534181712508746,
;;;  :df 88.93269487296278,
;;;  :n2 47,
;;;  :x-mean 144.19298245614036,
;;;  :y-mean 79.85106382978724,
;;;  :x-var 21588.694235588973,
;;;  :conf-int [19.375058288831156 109.30877896387508],
;;;  :y-var 6262.390379278448,
;;;  :t-stat 2.8435619003598913,
;;;  :n1 57}
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## Cohen's d
;;; 
;;; This is an adjustment we can use to see whether the difference is large or not.
;;; 
;;; $$
;;; d=\frac{\bar{a}-\bar{b}}{S\_{ab}}
;;; $$
;;; 
;;; Where @@S\_{ab}@@ is the *pooled standard deviation*
;; **

;; @@
(defn pooled-standard-deviation
  [a b]
  (i/sqrt (+ (i/sq (standard-deviation a))
             (i/sq (standard-deviation b)))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/pooled-standard-deviation</span>","value":"#'ws.ch2/pooled-standard-deviation"}
;; <=

;; @@
(let [a (->> (i/$where {:site {:$eq 0}} multi-data)
             (i/$ :dwell-time))
      b (->> (i/$where {:site {:$eq 6}} multi-data)
             (i/$ :dwell-time))]
  (/ (- (s/mean b)
        (s/mean a))
     (pooled-standard-deviation a b)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>0.3855431139260606</span>","value":"0.3855431139260606"}
;; <=

;; @@

;; @@
