;; gorilla-repl.fileformat = 1

;; **
;;; # Chapter 2 - Inference
;; **

;; @@
(ns ws.ch2
  (:require [clj-time.format :as f]
            [clj-time.predicates :as p]
            [medley.core :refer [map-vals]]
            [clj-time.core :as t]
            [incanter.charts :as c]
            [incanter.core :as i]
            [incanter.io :as iio]
            [incanter.stats :as s]
            [incanter.svg :as svg]
            [clj-time.coerce :as tc]
            [clojure.java.io :as io]
            [clojure.repl :refer [doc]]))

(use 'incanter-gorilla.render :reload)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## AcmeContent
;;; 
;;; Let's pretend we just got hired by **AcmeContent** to anlayze their website dwell time
;; **

;; @@
(defn load-data
  [file]
  (-> (io/resource file)
      (iio/read-dataset :header true :delim \tab)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/load-data</span>","value":"#'ws.ch2/load-data"}
;; <=

;; @@
(-> (load-data "dwell-times.tsv")
    (i/view))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>#object[javax.swing.JFrame 0x3b6f9bd8 &quot;javax.swing.JFrame[frame0,1280,0,400x600,invalid,layout=java.awt.BorderLayout,title=Incanter Dataset,resizable,normal,defaultCloseOperation=HIDE_ON_CLOSE,rootPane=javax.swing.JRootPane[,0,0,400x600,invalid,layout=javax.swing.JRootPane$RootLayout,alignmentX=0.0,alignmentY=0.0,border=,flags=16777673,maximumSize=,minimumSize=,preferredSize=],rootPaneCheckingEnabled=true]&quot;]</span>","value":"#object[javax.swing.JFrame 0x3b6f9bd8 \"javax.swing.JFrame[frame0,1280,0,400x600,invalid,layout=java.awt.BorderLayout,title=Incanter Dataset,resizable,normal,defaultCloseOperation=HIDE_ON_CLOSE,rootPane=javax.swing.JRootPane[,0,0,400x600,invalid,layout=javax.swing.JRootPane$RootLayout,alignmentX=0.0,alignmentY=0.0,border=,flags=16777673,maximumSize=,minimumSize=,preferredSize=],rootPaneCheckingEnabled=true]\"]"}
;; <=

;; @@
(-> (i/$ :dwell-time (load-data "dwell-times.tsv"))
    (c/histogram :nbins 50)
    (chart-view))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x17f44624 \"org.jfree.chart.JFreeChart@17f44624\"], :opts nil}"}
;; <=

;; @@
(-> (i/$ :dwell-time (load-data "dwell-times.tsv"))
    (c/histogram :nbins 50)
    (c/set-axis :y (c/log-axis))
    (chart-view))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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mmuuKXbv3l0cP368+O233zb/vdtvFlsH+WojP/nWz3jPnj224QY5ttV/bduAnq133323uP/++4vLly+neuCBB9I8yteRI0eKc+fOpZsq/P3338WJEycS4KuD3Dpo1iSb5Cff+jpz5swWONiG291m29p25Q7oWxQbw5dffrk5HY/vu+8+a7WBAuxXX3119uC2Dpo1x0H5ybe+Dhw4UFy6dMk2PGKgN9125Q7oW3TttdcmAFVhFPNoeJ09e7Y4ePDglsEdhy8D8vv37y9eeukl66Bmc2ySn3zrb7/PPvtsq+sA0Ifrv7ZtQG+84VX3Lqmefvjhh2Lfvn3F2tpa13+/cOFCcfjw4eKFF16wDobQMPnJt57uvffevveRtg23B/Sm267cAd0n6xHpq6++Km699dbim2++6fu8P/74I53AYh0Mp7r5yTdfccj26NGjra8DQLeHDuhjULfvYGIe1dOnn35a3HLLLcX3339fuxlaB82APig/+eYrvn/97rvvbMNjAnrTbVfugL5F5VmScZmVsySH01tvvVXs3bu352HKY8eOFT///HN6/OuvvxaPPvrolu8orYP+apqffPP09ddf9zyhyjbcDtA75zfdduUO6FcoLk9xHWOzwdvvOt3Ye7/rrrvSvJtvvjl99xiXt1kH+Uc/muYn38EKGHzxxRcjWwc7tRcMAn3TbVfugE5ERGNW/PgUAToREREBOhEREQE6ERERoBMRERGgExEREaATERERoBMREQE6jV6nT59OP9YQv1xVqtsPOgxS3efXfe9Rvv8gv6b+417+Ua/r7V6fk5Kn7Zg69cgjj6SMYqzlzAd0ak3//vtvceONNxZXXXXV5s9S9hu4x48fL26//XZAr7mck9AI667rWQN62//P6vs13T5sx9PVL/qt+xhbMX3DDTekMTdoPqBTa/rwww/TRnbkyJGs5990003FiRMnNqd///334rnnnks/ZRnvE7D/5JNPAH2K1jWgA/qs7YlvJ9BDDz/8cJr3wQcfZM0HdGpFjz/+eNrAotkPGhBxB6mYd+7cuc15ceg25sXtTuPvpUuXiqeffrrRgHv//ffTLVTjJx73799fvPfee1c8P+bHdPWe6fFhI/ZAS8V91eM5t91225b3jxtoHDp0KN0iMe57fPfddxcff/xx40bY7zeoe03HTSDK/+sdd9xRnD17tjh58mT6f8S8e+65p/jxxx9rL3/TdX3+/Pl0k5HwiIrHMa9Tb775Znpt7PXv2bMn3WwkPuTVXZ/9lPv6fssy6PfBc/4fdZu67bj5dhw3sXnqqaeK3bt3p+fEunnyySf73l653/IPer9Yznj+mTNntrxnTMf8uM99zrr/6KOP0rwYcznzAZ1aUdyuNDaw9fX1gU3+1KlTV9w7OAZFPO/PP/+s9Ym4V2P5/PPP0/zDhw+nhhoVjzufH0cJYjru0haKhlg+JxpgtUk///zzm6+L+61H037wwQfTh4849PXMM8+k50XDHdehynI6mkssQ8Cyc17c5COmo9HVXf4m6zo+sFXXQdzms1wH1Q9zoVdffbX45Zdf0uM4MhPPieWpuz57qc7rBy1LP89Br60LdNtxO9vxgQMH0rzyw+Rff/2VoB83wRlm+Qe93zvvvJP+Pb7vrqr8/jv+PQfo8cEh5sWYy5kP6NSKSiDnDIj49Nr5yTL2JuJ55Z5G7JXERjtsw4jbGMb86qf5cg+l+vyySRw9ejRNv/baa5vPiceh+LeYrt79KgZuzCubd+iff/65Yg9oXI2whGt8SOqcF4qmF1V3+Zus627rIB7HvF63Bq2+V+z91F2fvdTk9Z3LUueoQOdr68p23M52XL6uegSjyQ7DoPcLwMc4iefE7VRD8Tem40hD7LjUWYZuN5LpNR/QaWxAj0/R3b77iU/TsbFXD2/FdIB9GMWGnrM80Thi2eN2h6GHHnooPb7++uvTnlAopuM53Y4odKtqw8k91JjbMHOelzMvd/mbrOt+z4sjNKWiGcd3ggG+zm2g7vrslWfu63OWpde6yXmt7Xh7tuNyj7qEYOzlx1GNjY2NRnvo/d4vTvyNf3/99dfTdPyN6Zhf90MFoNNEHnIPQMdAu3z58hXvEWdvvvHGG+n55R57/B1lI6weBvv2229Tg4ijB1HxOObFv0Wj7vb+1eaY0xAmpRHmLn+TdZ0L9LI59jvEOy6g5yzLoCbf77W24+3ZjuNo37Fjx9J38dXlrB6+rwP0nPeL7/ar88p72Mf8XJWH1vfu3Zs1H9CpFeWeKBXPK08I6TeIAvg5n0CbHnIPvf3222leefgujh6UJ53Ed3PxN55TVZyEE/PjpJ0mjbCtQ5V1G2Hu8jdZ1+U6qB6W7HbIvRP85WU5gw7fj+KQe86y9PLMee2oDrnbjvO34/ie/bPPPkuvi3VWdxly3y9UfoUY66K8eqeOnBRH26Jyg+13KVN8io7Dft1+ECFeFydKld+dlc0wBuwwDaN6MlGcjBUVHt2ef/HixS2H6eLDRJx8VD1sGs+pKvZ4Yi8zBuiFCxfSvHhN5BBNuGkjjGtMy7P9R9EIc5d/2HUdKk9sisO/5Ulx5Tqofo8bezAxL5pifP9Z7mn2Ojls0PrsptzX5yxLr3WT89q6sh23sx3HNhhnmMd6qe49V3cuuvn1Wv6c9wvFSZLlNePV8xlyVV6e1vnVY6/5gE6tKD6llhttrx8bKRt8XLbWqfi3uHQtgF+eSBSHtIb9jqs8vL9v3770qTkGfEz3en75Sbo6IA8ePNj3JLHY83zsscfSspaDNs7IrV4KM2wjjMO2cSlM7qHOuo0wd/mHXdfV9RqNNY60xHqIPfPOM9yjEcfh6gBPHM4v9zS7Xb6Vuz6H3R5ylqXXusn9f9SV7bj5dhyPn3jiibQs5SWFnf2l23v3Wv6c9wuVJ8KVH7LKE+RyFNtT+f8pPzj0mw/o1Kpefvnl1LirPwdaVZw0kvOduJ+EnP51TUTNFGMrxtgrr7ySNR/Qaay68847s34sZtbP3CQiIkAnIiICdCIiIgJ0IiIiAnQiIiICdCIiIkAnIiIiQCciIiJAJyIionr6H9CfT6UldToMAAAAAElFTkSuQmCC\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x21942510 \"org.jfree.chart.JFreeChart@21942510\"], :opts nil}"}
;; <=

;; **
;;; ## Exponential distribution
;; **

;; @@
(let [dwell-times (->> (load-data "dwell-times.tsv")
                       (i/$ :dwell-time))]
  (println "Mean:   " (s/mean dwell-times))
  (println "Median: " (s/median dwell-times))
  (println "SD:     " (s/sd dwell-times)))
;; @@
;; ->
;;; Mean:    93.2014074074074
;;; Median:  64.0
;;; SD:      93.96972402519813
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(defn with-parsed-date
  [data]
  (i/transform-col data :date (comp tc/to-local-date f/parse)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/with-parsed-date</span>","value":"#'ws.ch2/with-parsed-date"}
;; <=

;; @@
(defn filter-weekdays
  [data]
  (i/$where {:date {:$fn p/weekday?}} data))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/filter-weekdays</span>","value":"#'ws.ch2/filter-weekdays"}
;; <=

;; @@
(defn mean-dwell-times-by-date
  [data]
  (i/$rollup :mean :dwell-time :date data))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/mean-dwell-times-by-date</span>","value":"#'ws.ch2/mean-dwell-times-by-date"}
;; <=

;; @@
(defn daily-mean-dwell-times
  [data]
  (->> (with-parsed-date data)
       (filter-weekdays)
       (mean-dwell-times-by-date)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/daily-mean-dwell-times</span>","value":"#'ws.ch2/daily-mean-dwell-times"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))]
  (println "Mean:   " (s/mean means))
  (println "Median: " (s/median means))
  (println "SD:     " (s/sd means)))
;; @@
;; ->
;;; Mean:    90.210428650562
;;; Median:  90.13661202185791
;;; SD:      3.722342905320035
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))]
  (-> (c/histogram means :nbins 20)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x637d26a9 \"org.jfree.chart.JFreeChart@637d26a9\"], :opts nil}"}
;; <=

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (daily-mean-dwell-times)
                 (i/$ :dwell-time))
      mean (s/mean means)
      sd (s/sd means)
      pdf (fn [x]
            (s/pdf-normal x :mean mean :sd sd))]
  (-> (c/histogram means :nbins 20 :density true)
      (c/add-function pdf 80 100)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x77a5b6f \"org.jfree.chart.JFreeChart@77a5b6f\"], :opts nil}"}
;; <=

;; **
;;; ## Standard Error
;;; 
;;; We have just calculated the **standard error** (the difference between the sample's mean and the grand mean) empirically, but we can do it by a single sample doing:
;;; 
;;; $$SE=\frac{\sigma_x}{\sqrt{n}}$$
;;; 
;;; Where @@\sigma_x@@ is the **standard deviation** and @@n@@ is the sample size.
;; **

;; @@
(defn standard-deviation
  [xs]
  (Math/sqrt (s/variance xs)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/standard-deviation</span>","value":"#'ws.ch2/standard-deviation"}
;; <=

;; @@
(defn standard-error
  [xs]
  (/ (standard-deviation xs)
     (Math/sqrt (count xs))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/standard-error</span>","value":"#'ws.ch2/standard-error"}
;; <=

;; @@
(defn filtered-times
  [filter data]
  (->> (i/$where filter data)
       (i/$ :dwell-time)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/filtered-times</span>","value":"#'ws.ch2/filtered-times"}
;; <=

;; @@
(let [may-1 (f/parse-local-date "2015-05-01")]
  (->> (load-data "dwell-times.tsv")
       (with-parsed-date)
       (filtered-times {:date {:$eq may-1}})
       (standard-error)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>3.6300706763962207</span>","value":"3.6300706763962207"}
;; <=

;; **
;;; ## Confidence Intervals
;; **

;; @@
(defn confidence-interval
  [p xs]
  (let [x-bar (s/mean xs)
        se (standard-error xs)
        z-crit (s/quantile-normal 
                 (- 1 (/ (- 1 p) 2)))]
    [(- x-bar (* se z-crit))
     (+ x-bar (* se z-crit))]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/confidence-interval</span>","value":"#'ws.ch2/confidence-interval"}
;; <=

;; @@
(let [may-1 (f/parse-local-date "2015-05-01")]
  (->> (load-data "dwell-times.tsv")
       (with-parsed-date)
       (filtered-times {:date {:$eq may-1}})
       (confidence-interval 0.95)))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>83.52880123548485</span>","value":"83.52880123548485"},{"type":"html","content":"<span class='clj-double'>97.75841680962793</span>","value":"97.75841680962793"}],"value":"[83.52880123548485 97.75841680962793]"}
;; <=

;; **
;;; ## Sample comparisons
;; **

;; @@
(let [times (->> (load-data "campaign-sample.tsv")
                 (i/$ :dwell-time))]
  (println "n:      " (count times))
  (println "Mean:   " (s/mean times))
  (println "Median: " (s/median times))
  (println "SD:     " (s/sd times))
  (println "SE:     " (standard-error times)))
;; @@
;; ->
;;; n:       300
;;; Mean:    130.22
;;; Median:  84.0
;;; SD:      136.13370714388046
;;; SE:      7.859683246530105
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(->> (load-data "campaign-sample.tsv")
     (i/$ :dwell-time)
     (confidence-interval 0.95))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>114.81530390690814</span>","value":"114.81530390690814"},{"type":"html","content":"<span class='clj-double'>145.62469609309184</span>","value":"145.62469609309184"}],"value":"[114.81530390690814 145.62469609309184]"}
;; <=

;; **
;;; ### Biased sample
;;; 
;;; If we inspect the sample given to us (**campaign-sample**), we will find that the data comes from a weekend, likely to be biased.
;; **

;; @@
(p/weekend? (t/date-time 2015 6 6))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>true</span>","value":"true"}
;; <=

;; **
;;; ### Visualizing different populations
;;; 
;;; Since we always filtered out weekends, let's check whether we have a difference between them and weekdays
;; **

;; @@
(let [means (->> (load-data "dwell-times.tsv")
                 (with-parsed-date)
                 (mean-dwell-times-by-date)
                 (i/$ :dwell-time))]
  (-> (c/histogram means :nbins 20)
      (chart-view)))
;; @@
;; =>
;;; {"type":"html","content":"<img src=\"data:image/PNG;base64,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\"/>","value":"#incanter_gorilla.render.ChartView{:content #object[org.jfree.chart.JFreeChart 0x5cc431f7 \"org.jfree.chart.JFreeChart@5cc431f7\"], :opts nil}"}
;; <=

;; **
;;; As we can easily see in the chart, the distribution isn't normal anymore, it is **bimodal**. The second peak is due to weekends
;; **

;; @@
(defn print-stats
  [data]
  (println "n:      " (count data))
  (println "Mean:   " (s/mean data))
  (println "Median: " (s/median data))
  (println "SD:     " (s/sd data))
  (println "SE:     " (standard-error data)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/print-stats</span>","value":"#'ws.ch2/print-stats"}
;; <=

;; @@
(let [wknd-times (->> (load-data "dwell-times.tsv")
                      (with-parsed-date)
                      (i/$where 
                        {:date {:$fn p/weekend?}})
                      (i/$ :dwell-time))]
  (print-stats wknd-times))
;; @@
;; ->
;;; n:       5860
;;; Mean:    117.78686006825939
;;; Median:  81.0
;;; SD:      120.65234077179389
;;; SE:      1.5761115224978066
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; ## Hypothesis testing
;;; 
;;; ### z-test
;;; 
;;; With **z-testing** we can compare 2 samples, since we have 2 samples we also have 2 standard errors. The **z-test** is performed against the pooled standard error, wich is:
;;; 
;;; $$\sigma_{ab}=\sqrt{\frac{\sigma_{a}^{2}}{n_a}+\frac{\sigma_{b}^{2}}{n_b}}$$
;;; 
;;; Where @@\sigma_{a}^{2}@@ is the variance of the sample @@a@@, and @@\sigma_{b}^{2}@@ is the variance of the sample @@b@@.
;; **

;; @@
(defn pooled-standard-error
  [a b]
  (i/sqrt (+ (/ (i/sq (standard-deviation a)) 
                (count a))
             (/ (i/sq (standard-deviation b))
                (count b)))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/pooled-standard-error</span>","value":"#'ws.ch2/pooled-standard-error"}
;; <=

;; **
;;; To determine if the difference we see is unexpectedly large, we take the ratio of the observed difference between the means over the pooled standard error:
;;; 
;;; $$z=\frac{\bar{a}-\bar{b}}{\sigma_{ab}}$$
;; **

;; @@
(defn z-stat
  [a b]
  (-> (- (s/mean a)
         (s/mean b))
      (/ (pooled-standard-error a b))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/z-stat</span>","value":"#'ws.ch2/z-stat"}
;; <=

;; **
;;; This **z** ratio tells us how many standard errors apart the means are. Since the standard error has a normal distribution, we can associate this difference with a probability
;; **

;; @@
(defn z-test
  [a b]
  (s/cdf-normal (z-stat a b)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ws.ch2/z-test</span>","value":"#'ws.ch2/z-test"}
;; <=

;; @@
(let [data (->> (load-data "new-site.tsv")
                (:rows)
                (group-by :site)
                (map-vals (partial map :dwell-time)))
      a (get data 0)
      b (get data 1)]
  (println "a n: " (count a))
  (println "b n: " (count b))
  (println "z-stat: " (z-stat a b))
  (println "p-value: " (z-test a b)))
;; @@
;; ->
;;; a n:  284
;;; b n:  16
;;; z-stat:  -1.5985205593851322
;;; p-value:  0.05496358680268404
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(doc map-vals)
;; @@
;; ->
;;; -------------------------
;;; medley.core/map-vals
;;; ([f coll])
;;;   Maps a function over the values of an associative collection.
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(map-vals (fn [x] (* x 2)) {:a 1 :b 2 :c 3})
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:a</span>","value":":a"},{"type":"html","content":"<span class='clj-long'>2</span>","value":"2"}],"value":"[:a 2]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:b</span>","value":":b"},{"type":"html","content":"<span class='clj-long'>4</span>","value":"4"}],"value":"[:b 4]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:c</span>","value":":c"},{"type":"html","content":"<span class='clj-long'>6</span>","value":"6"}],"value":"[:c 6]"}],"value":"{:a 2, :b 4, :c 6}"}
;; <=

;; @@

;; @@
